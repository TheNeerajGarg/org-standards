# Introspection: Fix Pre-Commit Hook Circular Dependency

**Date**: 2025-10-27
**Type**: correction
**Focus**: Fix circular dependency in pre-commit hook (hashâ†’timestamp)

---

## Purpose

Fix pre-commit hook to use timestamp-based introspection naming (consistent with bot workflows) to eliminate circular dependency.

**User correctly identified problem**: "We had implemented a workflow so the introspection document will be generated before the commit, and moved away from hash, to just time-stamp. What happened? Why are we in circular loop again?"

---

## Challenges Encountered

None - straightforward regex fix once user identified the inconsistency.

---

## Mistakes Made

**Inconsistent naming standards**: Two schemes coexisted:
- Humans/Claude: `commit-$HASH.md` (hash-based, causes circular dependency)
- Bots: `commit-$TIMESTAMP.md` (timestamp-based, no issues)

**Root cause**: Bot workflows evolved independently, pre-commit hook wasn't synced.

---

## How to Avoid Next Time

### What Human Could Have Done Differently

N/A - User correctly caught the issue and asked the right questions:
- "how do we ensure that we use the exact same workflow everywhere?"
- "Do we have two different hooks? We need to have exactly one copy everywhere."
- "What other hooks could have this problem?"

### What Bot Could Have Done Differently

**Pattern matching failure**: When implementing timestamp-based naming for bots, should have immediately updated ALL components (hook + workflows), not just workflows.

**Rule**: When changing a naming convention or standard, grep for ALL occurrences and update consistently.

### What System Could Have Done Differently

**Hook drift is a known problem**: Source in org-standards, installed copy in each repo's `.git/hooks/`.

**Mitigation needed**:
1. CI check: Verify installed hooks match source (hash comparison)
2. Auto-update: Dev-setup re-installs from org-standards
3. Version comment in hooks for tracking
